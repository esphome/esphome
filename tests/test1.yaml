---
substitutions:
  devicename: test1
  sensorname: my
  textname: template
  roomname: living_room

esphome:
  name: test1
  name_add_mac_suffix: true
  platform: ESP32
  board: nodemcu-32s
  platformio_options:
    board_build.partitions: huge_app.csv
  on_boot:
    priority: 150.0
    then:
      - lambda: >-
          ESP_LOGD("main", "ON BOOT!");
  on_shutdown:
    then:
      - lambda: >-
          ESP_LOGD("main", "ON SHUTDOWN!");
  on_loop:
    then:
      - lambda: >-
          ESP_LOGV("main", "ON LOOP!");
  build_path: build/test1

packages:
  wifi: !include test_packages/test_packages_package_wifi.yaml
  pkg_test: !include test_packages/test_packages_package1.yaml

wifi:
  networks:
    - ssid: "MySSID"
      password: "password1"
    - ssid: "MySSID2"
      password: ""
      channel: 14
      bssid: "A1:63:95:47:D3:1D"
  manual_ip:
    static_ip: 192.168.178.230
    gateway: 192.168.178.1
    subnet: 255.255.255.0
    dns1: 1.1.1.1
    dns2: 1.2.2.1
  domain: .local
  reboot_timeout: 120s
  power_save_mode: light

network:
  enable_ipv6: true

mdns:
  disabled: false

mqtt:
  broker: "192.168.178.84"
  port: 1883
  username: "debug"
  password: "debug"
  client_id: someclient
  use_abbreviations: false
  discovery: true
  discovery_retain: false
  discovery_prefix: discovery
  discovery_unique_id_generator: legacy
  topic_prefix: helloworld
  log_topic:
    topic: helloworld/hi
    level: INFO
  birth_message:
  will_message:
  shutdown_message:
    topic: topic/to/send/to
    payload: hi
    qos: 2
    retain: true
  keepalive: 60s
  reboot_timeout: 60s
  on_message:
    - topic: my/custom/topic
      qos: 0
      then:
        - lambda: >-
            ESP_LOGD("main", "Got message %s", x.c_str());
    - topic: livingroom/ota_mode
      then:
        - deep_sleep.prevent
        - deep_sleep.allow
    - topic: livingroom/ota_mode
      then:
        - deep_sleep.enter:
  on_json_message:
    topic: the/topic
    then:
      - if:
          condition:
            - wifi.connected:
            - mqtt.connected:
          then:
            - lambda: |-
                int data = x["my_data"];
                ESP_LOGD("main", "The data is: %d", data);
            - uart.write:
                id: uart_0
                data: Hello World
            - uart.write:
                id: uart_0
                data: [0x00, 0x20, 0x30]
            - uart.write:
                id: uart_0
                data: !lambda |-
                  return {};

i2c:
  sda:
    allow_other_uses: true
    number: 21
  scl:
    allow_other_uses: true
    number: 22
  scan: true
  frequency: 100kHz
  setup_priority: -100
  id: i2c_bus

spi:
  id: spi_bus
  clk_pin:
    allow_other_uses: true
    number: GPIO21
  mosi_pin:
    allow_other_uses: true
    number: GPIO22
  miso_pin:
    allow_other_uses: true
    number: GPIO23

uart:
  - tx_pin:
      allow_other_uses: true
      number: GPIO22
      inverted: true
    rx_pin:
      allow_other_uses: true
      number: GPIO23
      inverted: true
    baud_rate: 115200
    id: uart_0
    parity: NONE
    data_bits: 8
    stop_bits: 1
    rx_buffer_size: 512
    debug:
      dummy_receiver: true
      direction: both
      after:
        bytes: 50
        timeout: 500ms
        delimiter: "\r\n"
      sequence:
        - lambda: UARTDebug::log_hex(direction, bytes, ':');
        - lambda: UARTDebug::log_string(direction, bytes);
        - lambda: UARTDebug::log_int(direction, bytes, ',');
        - lambda: UARTDebug::log_binary(direction, bytes, ';');

ota:
  safe_mode: true
  password: "superlongpasswordthatnoonewillknow"
  port: 3286
  reboot_timeout: 2min
  num_attempts: 5
  on_state_change:
    then:
      lambda: >-
        ESP_LOGD("ota", "State %d", state);
  on_begin:
    then:
      logger.log: OTA begin
  on_progress:
    then:
      lambda: >-
        ESP_LOGD("ota", "Got progress %f", x);
  on_end:
    then:
      logger.log: OTA end
  on_error:
    then:
      lambda: >-
        ESP_LOGD("ota", "Got error code %d", x);

logger:
  baud_rate: 0
  level: VERBOSE
  logs:
    mqtt.component: DEBUG
    mqtt.client: ERROR

web_server:
  port: 8080
  version: 2

power_supply:
  id: atx_power_supply
  enable_time: 20ms
  keep_on_time: 10s
  pin:
    number: 13
    allow_other_uses: true
    inverted: true

deep_sleep:
  run_duration: 20s
  sleep_duration: 50s
  wakeup_pin:
    allow_other_uses: true
    number: GPIO2
    ignore_strapping_warning: true
  wakeup_pin_mode: INVERT_WAKEUP

ads1115:
  address: 0x48
  i2c_id: i2c_bus

ads1118:
  spi_id: spi_bus
  cs_pin:
    allow_other_uses: true
    number: GPIO12

dallas:
  pin:
    allow_other_uses: true
    number: GPIO23

esp32_ble:
  io_capability: keyboard_only

esp32_ble_tracker:

ble_client:
  - mac_address: AA:BB:CC:DD:EE:FF
    id: ble_foo
    auto_connect: true
  - mac_address: 11:22:33:44:55:66
    id: ble_blah
    auto_connect: false
    on_connect:
      then:
        - switch.turn_on: ble1_status
    on_disconnect:
      then:
        - switch.turn_on: ble1_status
    on_passkey_request:
      then:
        - ble_client.passkey_reply:
            id: ble_blah
            passkey: 123456
    on_passkey_notification:
      then:
        - logger.log: "Passkey notification received"
    on_numeric_comparison_request:
      then:
        - ble_client.numeric_comparison_reply:
            id: ble_blah
            accept: true
  - mac_address: C4:4F:33:11:22:33
    id: my_bedjet_ble_client

mcp23s08:
  - id: mcp23s08_hub
    cs_pin:
      ignore_strapping_warning: true
      number: GPIO12
      allow_other_uses: true
    deviceaddress: 0

mcp23s17:
  - id: mcp23s17_hub
    cs_pin:
      ignore_strapping_warning: true
      number: GPIO12
      allow_other_uses: true
    deviceaddress: 1

micronova:
  enable_rx_pin:
    allow_other_uses: true
    number: 4
  uart_id: uart_0

sensor:
  - platform: pmwcs3
    i2c_id: i2c_bus
    e25:
      name: pmwcs3_e25
    ec:
      name: pmwcs3_ec
    temperature:
      name: pmwcs3_temperature
    vwc:
      name: pmwcs3_vwc
  - platform: ble_client
    type: characteristic
    ble_client_id: ble_foo
    name: Green iTag btn
    service_uuid: ffe0
    characteristic_uuid: ffe1
    descriptor_uuid: ffe2
    notify: true
    update_interval: never
    lambda: |-
      ESP_LOGD("main", "Length of data is %i", x.size());
      return x[0];
    on_notify:
      then:
        - lambda: |-
            ESP_LOGD("green_btn", "Button was pressed, val%f", x);
  - platform: ble_client
    type: rssi
    ble_client_id: ble_foo
    name: Green iTag RSSI
    update_interval: 15s
  - platform: ads1115
    multiplexer: A0_A1
    gain: 1.024
    id: ${sensorname}_sensor
    filters:
    state_topic: hi/me
    retain: false
    availability:
  - platform: ads1118
    name: ads1118 adc
    multiplexer: A0_A1
    gain: 1.024
    type: adc
  - platform: ads1118
    name: ads1118 temperature
    type: temperature
  - platform: max44009
    name: Outside Brightness 1
    internal: true
    address: 0x4A
    update_interval: 30s
    mode: low_power
    i2c_id: i2c_bus
  - platform: dallas
    address: 0x1C0000031EDD2A28
    name: Living Room Temperature
    id: dallas_temperature
    resolution: 9
  - platform: dallas
    index: 1
    name: Living Room Temperature 2
  - platform: ina219
    address: 0x40
    shunt_resistance: 0.1 ohm
    current:
      name: INA219 Current
    power:
      name: INA219 Power
    bus_voltage:
      name: INA219 Bus Voltage
    shunt_voltage:
      name: INA219 Shunt Voltage
    max_voltage: 32.0V
    max_current: 3.2A
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: ina226
    address: 0x40
    shunt_resistance: 0.1 ohm
    current:
      name: INA226 Current
    power:
      name: INA226 Power
    bus_voltage:
      name: INA226 Bus Voltage
    shunt_voltage:
      name: INA226 Shunt Voltage
    max_current: 3.2A
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: ina3221
    address: 0x40
    channel_1:
      shunt_resistance: 0.1 ohm
      current:
        name: INA3221 Channel 1 Current
      power:
        name: INA3221 Channel 1 Power
      bus_voltage:
        name: INA3221 Channel 1 Bus Voltage
      shunt_voltage:
        name: INA3221 Channel 1 Shunt Voltage
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: max6675
    name: Living Room Temperature
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    update_interval: 15s
  - platform: max31855
    name: Den Temperature
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    update_interval: 15s
    reference_temperature:
      name: MAX31855 Internal Temperature
  - platform: max31856
    name: BBQ Temperature
    cs_pin:
      allow_other_uses: true
      number: GPIO17
    update_interval: 15s
    mains_filter: 50Hz
  - platform: max31865
    name: Water Tank Temperature
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    update_interval: 15s
    reference_resistance: 430 Ω
    rtd_nominal_resistance: 100 Ω
  - platform: mhz19
    uart_id: uart_0
    co2:
      name: MH-Z19 CO2 Value
    temperature:
      name: MH-Z19 Temperature
    update_interval: 15s
    automatic_baseline_calibration: false
  - platform: mpu6050
    address: 0x68
    accel_x:
      name: MPU6050 Accel X
    accel_y:
      name: MPU6050 Accel Y
    accel_z:
      name: MPU6050 Accel z
    gyro_x:
      name: MPU6050 Gyro X
    gyro_y:
      name: MPU6050 Gyro Y
    gyro_z:
      name: MPU6050 Gyro z
    temperature:
      name: MPU6050 Temperature
    i2c_id: i2c_bus
  - platform: mpu6886
    address: 0x68
    accel_x:
      name: MPU6886 Accel X
    accel_y:
      name: MPU6886 Accel Y
    accel_z:
      name: MPU6886 Accel z
    gyro_x:
      name: MPU6886 Gyro X
    gyro_y:
      name: MPU6886 Gyro Y
    gyro_z:
      name: MPU6886 Gyro z
    temperature:
      name: MPU6886 Temperature
    i2c_id: i2c_bus
  - platform: mmc5603
    address: 0x30
    field_strength_x:
      name: HMC5883L Field Strength X
    field_strength_y:
      name: HMC5883L Field Strength Y
    field_strength_z:
      name: HMC5883L Field Strength Z
    i2c_id: i2c_bus
  - platform: ms5611
    temperature:
      name: Outside Temperature
    pressure:
      name: Outside Pressure
    address: 0x77
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: pmsa003i
    pm_1_0:
      name: PMSA003i PM1.0
    pm_2_5:
      name: PMSA003i PM2.5
    pm_10_0:
      name: PMSA003i PM10.0
    pmc_0_3:
      name: PMSA003i PMC <0.3µm
    pmc_0_5:
      name: PMSA003i PMC <0.5µm
    pmc_1_0:
      name: PMSA003i PMC <1µm
    pmc_2_5:
      name: PMSA003i PMC <2.5µm
    pmc_5_0:
      name: PMSA003i PMC <5µm
    pmc_10_0:
      name: PMSA003i PMC <10µm
    address: 0x12
    standard_units: true
    i2c_id: i2c_bus
  - platform: pulse_counter
    name: Pulse Counter
    pin:
      ignore_strapping_warning: true
      number: GPIO12
      allow_other_uses: true
    count_mode:
      rising_edge: INCREMENT
      falling_edge: DECREMENT
    internal_filter: 13us
    update_interval: 15s
  - platform: pulse_meter
    name: Pulse Meter
    id: pulse_meter_sensor
    pin:
      ignore_strapping_warning: true
      number: GPIO12
      allow_other_uses: true
    internal_filter: 100ms
    timeout: 2 min
    on_value:
      - pulse_meter.set_total_pulses:
          id: pulse_meter_sensor
          value: 12345
    total:
      name: Pulse Meter Total
  - platform: rotary_encoder
    name: Rotary Encoder
    id: rotary_encoder1
    pin_a:
      allow_other_uses: true
      number: GPIO23
    pin_b:
      allow_other_uses: true
      number: GPIO25
    pin_reset:
      allow_other_uses: true
      number: GPIO25
    filters:
      - or:
          - debounce: 0.1s
          - delta: 10
    resolution: 4
    min_value: -10
    max_value: 30
    on_value:
      - sensor.rotary_encoder.set_value:
          id: rotary_encoder1
          value: 10
      - sensor.rotary_encoder.set_value:
          id: rotary_encoder1
          value: !lambda "return -1;"
    on_clockwise:
      - logger.log: Clockwise
    on_anticlockwise:
      - logger.log: Anticlockwise
  - platform: pulse_width
    name: Pulse Width
    pin:
      allow_other_uses: true
      number: GPIO12
  - platform: sm300d2
    uart_id: uart_0
    co2:
      name: SM300D2 CO2 Value
    formaldehyde:
      name: SM300D2 Formaldehyde Value
    tvoc:
      name: SM300D2 TVOC Value
    pm_2_5:
      name: SM300D2 PM2.5 Value
    pm_10_0:
      name: SM300D2 PM10 Value
    temperature:
      name: SM300D2 Temperature Value
    humidity:
      name: SM300D2 Humidity Value
    update_interval: 60s
  - platform: sht3xd
    temperature:
      name: Living Room Temperature 8
    humidity:
      name: Living Room Humidity 8
    address: 0x44
    i2c_id: i2c_bus
    update_interval: 15s
  - platform: sts3x
    name: Living Room Temperature 9
    address: 0x4A
    i2c_id: i2c_bus
  - platform: scd30
    co2:
      name: Living Room CO2 9
    temperature:
      id: scd30_temperature
      name: Living Room Temperature 9
    humidity:
      name: Living Room Humidity 9
    address: 0x61
    update_interval: 15s
    automatic_self_calibration: true
    altitude_compensation: 10m
    ambient_pressure_compensation: 961mBar
    temperature_offset: 4.2C
    i2c_id: i2c_bus
  - platform: scd4x
    id: scd40
    co2:
      name: SCD4X CO2
    temperature:
      id: scd4x_temperature
      name: SCD4X Temperature
    humidity:
      name: SCD4X Humidity
    update_interval: 15s
    automatic_self_calibration: true
    altitude_compensation: 10m
    ambient_pressure_compensation: 961mBar
    temperature_offset: 4.2C
    i2c_id: i2c_bus
  - platform: sfa30
    formaldehyde:
      name: "SFA30 formaldehyde"
    temperature:
      name: "SFA30 temperature"
    humidity:
      name: "SFA30 humidity"
    i2c_id: i2c_bus
    address: 0x5D
    update_interval: 30s
  - platform: sen0321
    name: Workshop Ozone Sensor
    id: sen0321_ozone
    update_interval: 10s
    i2c_id: i2c_bus
  - platform: sgp30
    eco2:
      name: Workshop eCO2
      accuracy_decimals: 1
    tvoc:
      name: Workshop TVOC
      accuracy_decimals: 1
    address: 0x58
    update_interval: 5s
    i2c_id: i2c_bus
  - platform: sps30
    pm_1_0:
      name: Workshop PM <1µm Weight concentration
      id: workshop_PM_1_0
    pm_2_5:
      name: Workshop PM <2.5µm Weight concentration
      id: workshop_PM_2_5
    pm_4_0:
      name: Workshop PM <4µm Weight concentration
      id: workshop_PM_4_0
    pm_10_0:
      name: Workshop PM <10µm Weight concentration
      id: workshop_PM_10_0
    pmc_0_5:
      name: Workshop PM <0.5µm Number concentration
      id: workshop_PMC_0_5
    pmc_1_0:
      name: Workshop PM <1µm Number concentration
      id: workshop_PMC_1_0
    pmc_2_5:
      name: Workshop PM <2.5µm Number concentration
      id: workshop_PMC_2_5
    pmc_4_0:
      name: Workshop PM <4µm Number concentration
      id: workshop_PMC_4_0
    pmc_10_0:
      name: Workshop PM <10µm Number concentration
      id: workshop_PMC_10_0
    address: 0x69
    update_interval: 10s
    i2c_id: i2c_bus
  - platform: sht4x
    temperature:
      name: SHT4X Temperature
    humidity:
      name: SHT4X Humidity
    address: 0x44
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: shtcx
    temperature:
      name: Living Room Temperature 10
    humidity:
      name: Living Room Humidity 10
    address: 0x70
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: tsl2561
    name: TSL2561 Ambient Light
    address: 0x39
    update_interval: 15s
    is_cs_package: true
    integration_time: 402ms
    gain: 16x
    i2c_id: i2c_bus
  - platform: tsl2591
    id: this_little_light_of_mine
    address: 0x29
    update_interval: 15s
    integration_time: 600ms
    gain: high
    visible:
      name: tsl2591 visible
      id: tsl2591_vis
      unit_of_measurement: pH
    infrared:
      name: tsl2591 infrared
      id: tsl2591_ir
    full_spectrum:
      name: tsl2591 full_spectrum
      id: tsl2591_fs
    calculated_lux:
      name: tsl2591 calculated_lux
      id: tsl2591_cl
    i2c_id: i2c_bus
  - platform: tee501
    name: Office Temperature 3
    address: 0x48
    i2c_id: i2c_bus
  - id: !extend ${devicename}_uptime_pcg
    unit_of_measurement: s
  - platform: mqtt_subscribe
    name: MQTT Subscribe Sensor 1
    topic: mqtt/topic
    id: the_sensor
    qos: 2
    on_value:
      - mqtt.publish_json:
          topic: the/topic
          payload: |-
            root["key"] = id(the_sensor).state;
            root["greeting"] = "Hello World";
  - platform: sds011
    uart_id: uart_0
    pm_2_5:
      name: SDS011 PM2.5
    pm_10_0:
      name: SDS011 PM10.0
    update_interval: 5min
    rx_only: false
  - platform: tx20
    wind_speed:
      name: Windspeed
    wind_direction_degrees:
      name: Winddirection Degrees
    pin:
      number: GPIO04
      mode: INPUT
      allow_other_uses: true
  - platform: tmp117
    name: TMP117 Temperature
    update_interval: 5s
    i2c_id: i2c_bus
  - platform: teleinfo
    tag_name: HCHC
    name: hchc
    unit_of_measurement: Wh
    icon: mdi:flash
    teleinfo_id: myteleinfo
  - platform: mcp9808
    name: MCP9808 Temperature
    update_interval: 15s
    i2c_id: i2c_bus
  - platform: sdp3x
    name: HVAC Filter Pressure drop
    id: filter_pressure
    update_interval: 5s
    accuracy_decimals: 3
    i2c_id: i2c_bus
  - platform: max9611
    i2c_id: i2c_bus
    shunt_resistance: 0.2 ohm
    gain: 1X
    voltage:
      name: Max9611 Voltage
    current:
      name: Max9611 Current
    power:
      name: Max9611 Watts
    temperature:
      name: Max9611 Temp
    update_interval: 1s
  - platform: mlx90614
    i2c_id: i2c_bus
    ambient:
      name: Ambient
    object:
      name: Object
      emissivity: 1.0
  - platform: mpl3115a2
    i2c_id: i2c_bus
    temperature:
      name: "MPL3115A2 Temperature"
    pressure:
      name: "MPL3115A2 Pressure"
    update_interval: 10s
  - platform: sen21231
    name: "Person Sensor"
    i2c_id: i2c_bus
  - platform: iaqcore
    i2c_id: i2c_bus
    co2:
      name: "iAQ Core CO2 Sensor"
    tvoc:
      name: "iAQ Core TVOC Sensor"
  - platform: tmp1075
    name: "Temperature TMP1075"
    update_interval: 10s
    i2c_id: i2c_bus
    conversion_rate: 27.5ms
    alert:
      limit_low: 50
      limit_high: 75
      fault_count: 1
      polarity: active_high
      function: comparator
  - platform: debug
    free:
      name: "Heap Free"
    block:
      name: "Heap Max Block"
    loop_time:
      name: "Loop Time"
    psram:
      name: "PSRAM Free"
  - platform: mmc5983
    i2c_id: i2c_bus
    field_strength_x:
      name: "Magnet X"
      id: magnet_x
    field_strength_y:
      name: "Magnet Y"
      id: magnet_y
    field_strength_z:
      name: "Magnet Z"
      id: magnet_z
  - platform: micronova
    room_temperature:
      name: Room Temperature
    fumes_temperature:
      name: Fumes Temperature
    water_temperature:
      name: Water temperature
    water_pressure:
      name: Water pressure
    stove_power:
      name: Stove Power
    fan_speed:
      fan_rpm_offset: 240
      name: Fan RPM
    memory_address_sensor:
      memory_location: 0x20
      memory_address: 0x7d
      name: Adres sensor
  - platform: ade7880
    i2c_id: i2c_bus
    irq0_pin:
      number: GPIO13
      allow_other_uses: true
    irq1_pin:
      number: GPIO5
      allow_other_uses: true
    reset_pin:
      number: GPIO16
      allow_other_uses: true
    frequency: 60Hz
    phase_a:
      name: Channel A
      voltage: Voltage
      current: Current
      active_power: Active Power
      power_factor: Power Factor
      forward_active_energy: Forward Active Energy
      reverse_active_energy: Reverse Active Energy
      calibration:
        current_gain: 3116628
        voltage_gain: -757178
        power_gain: -1344457
        phase_angle: 188
    phase_b:
      name: Channel B
      voltage: Voltage
      current: Current
      active_power: Active Power
      power_factor: Power Factor
      forward_active_energy: Forward Active Energy
      reverse_active_energy: Reverse Active Energy
      calibration:
        current_gain: 3133655
        voltage_gain: -755235
        power_gain: -1345638
        phase_angle: 188
    phase_c:
      name: Channel C
      voltage: Voltage
      current: Current
      active_power: Active Power
      power_factor: Power Factor
      forward_active_energy: Forward Active Energy
      reverse_active_energy: Reverse Active Energy
      calibration:
        current_gain: 3111158
        voltage_gain: -743813
        power_gain: -1351437
        phase_angle: 180
    neutral:
      name: Neutral
      current: Current
      calibration:
        current_gain: 3189

psram:

binary_sensor:
  - platform: gpio
    name: "MCP23S08 Pin #1"
    pin:
      mcp23xxx: mcp23s08_hub
      # Use pin number 1
      number: 1
      # One of INPUT or INPUT_PULLUP
      mode: INPUT_PULLUP
      inverted: false
  - platform: gpio
    name: "MCP23S17 Pin #1"
    pin:
      mcp23xxx: mcp23s17_hub
      # Use pin number 1
      number: 1
      allow_other_uses: true
      # One of INPUT or INPUT_PULLUP
      mode: INPUT_PULLUP
      inverted: false
  - platform: gpio
    name: "MCP23S17 Pin #1 with interrupt"
    pin:
      mcp23xxx: mcp23s17_hub
      # Use pin number 1
      allow_other_uses: true
      number: 1
      # One of INPUT or INPUT_PULLUP
      mode: INPUT_PULLUP
      inverted: false
      interrupt: FALLING
  - platform: gpio
    pin:
      allow_other_uses: true
      number: GPIO9
    name: Living Room Window
    device_class: window
    filters:
      - invert:
      - delayed_on_off: 40ms
      - delayed_on_off:
          time_on: 10s
          time_off: !lambda "return 1000;"
      - delayed_on: 40ms
      - delayed_off: 40ms
      - delayed_on_off: !lambda "return 10;"
      - delayed_on: !lambda "return 1000;"
      - delayed_off: !lambda "return 0;"
      - settle: 40ms
      - settle: !lambda "return 10;"
    on_press:
      then:
        - lambda: >-
            ESP_LOGD("main", "Pressed");
    on_release:
      then:
        - lambda: >-
            ESP_LOGD("main", "Released");
    on_click:
      - min_length: 50ms
        max_length: 350ms
        then:
          - lambda: >-
              ESP_LOGD("main", "Clicked");
      - then:
          - lambda: >-
              ESP_LOGD("main", "Clicked");
    on_double_click:
      - min_length: 50ms
        max_length: 350ms
        then:
          - lambda: >-
              ESP_LOGD("main", "Double Clicked");
      - then:
          - lambda: >-
              ESP_LOGD("main", "Double Clicked");
    on_multi_click:
      - timing:
          - ON for at most 1s
          - OFF for at most 1s
          - ON for at most 1s
          - OFF for at least 0.2s
        then:
          - logger.log:
              format: Multi Clicked TWO
              level: warn
      - timing:
          - OFF for 1s to 2s
          - ON for 1s to 2s
          - OFF for at least 0.5s
        then:
          - logger.log:
              format: Multi Clicked LONG SINGLE
              level: warn
      - timing:
          - ON for at most 1s
          - OFF for at least 0.5s
        then:
          - logger.log:
              format: Multi Clicked SINGLE
              level: warn
    id: binary_sensor1
  - platform: gpio
    pin:
      number: GPIO9
      allow_other_uses: true
      mode: INPUT_PULLUP
    name: Living Room Window 2
  - platform: gpio
    pin:
      number: GPIO9
      allow_other_uses: true
      mode: INPUT_OUTPUT_OPEN_DRAIN
    name: Living Room Button
  - platform: status
    name: Living Room Status
  - platform: template
    name: Garage Door Open
    id: garage_door
    lambda: |-
      if (isnan(id(${sensorname}_sensor).state)) {
        // isnan checks if the ultrasonic sensor echo
        // has timed out, resulting in a NaN (not a number) state
        // in that case, return {} to indicate that we don't know.
        return {};
      } else if (id(${sensorname}_sensor).state > 30) {
        // Garage Door is open.
        return true;
      } else {
        // Garage Door is closed.
        return false;
      }
    on_press:
      - binary_sensor.template.publish:
          id: garage_door
          state: false
  - platform: pn532
    pn532_id: pn532_bs
    uid: 74-10-37-94
    name: PN532 NFC Tag
  - platform: rdm6300
    uid: 7616525
    name: RDM6300 NFC Tag
  - platform: gpio
    name: PCF binary sensor
    pin:
      pcf8574: pcf8574_hub
      number: 1
      mode: INPUT
      inverted: true
  - platform: gpio
    name: PCA9554 binary sensor
    pin:
      pca9554: pca9554_hub
      number: 1
      mode: INPUT
      inverted: true
  - platform: gpio
    name: PCA6416A binary sensor
    pin:
      pca6416a: pca6416a_hub
      number: 15
      mode: INPUT
      inverted: true
  - platform: gpio
    name: MCP21 binary sensor
    pin:
      mcp23xxx: mcp23017_hub
      number: 1
      allow_other_uses: true
      mode: INPUT
      inverted: true
  - platform: gpio
    name: MCP22 binary sensor
    pin:
      mcp23xxx: mcp23008_hub
      number: 7
      mode: INPUT_PULLUP
      inverted: false
  - platform: gpio
    name: MCP23 binary sensor
    pin:
      mcp23016: mcp23016_hub
      number: 7
      mode: INPUT
      inverted: false
  - platform: gpio
    name: Speed Fan Cycle binary sensor"
    pin:
      number: 18
      allow_other_uses: true
      mode:
        input: true
        pulldown: true
  - platform: template
    id: open_endstop_sensor
  - platform: template
    id: open_sensor
  - platform: template
    id: open_obstacle_sensor

  - platform: template
    id: close_endstop_sensor
  - platform: template
    id: close_sensor
  - platform: template
    id: close_obstacle_sensor
  - platform: nfc
    nfcc_id: nfcc_pn7160_i2c
    ndef_contains: pulse
    name: MFC Tag 1
  - platform: nfc
    nfcc_id: nfcc_pn7160_i2c
    tag_id: pulse
    name: MFC Tag 2
  - platform: nfc
    nfcc_id: nfcc_pn7160_i2c
    uid: 59-FC-AB-15
    name: MFC Tag 3

pca9685:
  frequency: 500
  address: 0x0
  i2c_id: i2c_bus

tlc59208f:
  - address: 0x20
    id: tlc59208f_1
    i2c_id: i2c_bus
  - address: 0x22
    id: tlc59208f_2
    i2c_id: i2c_bus
  - address: 0x24
    id: tlc59208f_3
    i2c_id: i2c_bus

my9231:
  data_pin:
    allow_other_uses: true
    number: GPIO12
  clock_pin:
    number: GPIO14
  num_channels: 6
  num_chips: 2
  bit_depth: 16

sm2235:
  data_pin:
    allow_other_uses: true
    number: GPIO4
  clock_pin:
    allow_other_uses: true
    number: GPIO5
  max_power_color_channels: 9
  max_power_white_channels: 9

sm2335:
  data_pin:
    allow_other_uses: true
    number: GPIO4
  clock_pin:
    allow_other_uses: true
    number: GPIO5
  max_power_color_channels: 9
  max_power_white_channels: 9

output:
  - platform: gpio
    pin:
      allow_other_uses: true
      number: GPIO26
    id: gpio_26
    power_supply: atx_power_supply
    inverted: false
  - platform: ledc
    pin:
      number: 19
    id: gpio_19
    frequency: 1500Hz
    channel: 14
    max_power: 0.5
  - platform: pca9685
    id: pca_0
    channel: 0
  - platform: pca9685
    id: pca_1
    channel: 1
  - platform: pca9685
    id: pca_2
    channel: 2
  - platform: pca9685
    id: pca_3
    channel: 3
  - platform: pca9685
    id: pca_4
    channel: 4
  - platform: pca9685
    id: pca_5
    channel: 5
  - platform: pca9685
    id: pca_6
    channel: 6
  - platform: pca9685
    id: pca_7
    channel: 7
  - platform: tlc59208f
    id: tlc_0
    channel: 0
    tlc59208f_id: tlc59208f_1
  - platform: tlc59208f
    id: tlc_1
    channel: 1
    tlc59208f_id: tlc59208f_1
  - platform: tlc59208f
    id: tlc_2
    channel: 2
    tlc59208f_id: tlc59208f_1
  - platform: tlc59208f
    id: tlc_3
    channel: 0
    tlc59208f_id: tlc59208f_2
  - platform: tlc59208f
    id: tlc_4
    channel: 1
    tlc59208f_id: tlc59208f_2
  - platform: tlc59208f
    id: tlc_5
    channel: 2
    tlc59208f_id: tlc59208f_2
  - platform: tlc59208f
    id: tlc_6
    channel: 0
    tlc59208f_id: tlc59208f_3
  - platform: tlc59208f
    id: tlc_7
    channel: 1
    tlc59208f_id: tlc59208f_3
  - platform: tlc59208f
    id: tlc_8
    channel: 2
    tlc59208f_id: tlc59208f_3
  - platform: gpio
    id: id2
    pin:
      pcf8574: pcf8574_hub
      number: 0
      # allow_other_uses: true
      mode: OUTPUT
      inverted: false
  - platform: gpio
    id: id26
    pin:
      pca9554: pca9554_hub
      number: 0
      # allow_other_uses: true
      mode: OUTPUT
      inverted: false
  - platform: gpio
    id: id22
    pin:
      mcp23xxx: mcp23017_hub
      number: 0
      mode: OUTPUT
      inverted: false
  - platform: gpio
    id: id23
    pin:
      mcp23xxx: mcp23008_hub
      number: 0
      mode: OUTPUT
      inverted: false
  - platform: gpio
    id: id25
    pin:
      mcp23016: mcp23016_hub
      number: 0
      mode: OUTPUT
      inverted: false
  - platform: my9231
    id: my_0
    channel: 0
  - platform: my9231
    id: my_1
    channel: 1
  - platform: my9231
    id: my_2
    channel: 2
  - platform: my9231
    id: my_3
    channel: 3
  - platform: my9231
    id: my_4
    channel: 4
  - platform: my9231
    id: my_5
    channel: 5
  - platform: sm2235
    id: sm2235_red
    channel: 1
  - platform: sm2235
    id: sm2235_green
    channel: 0
  - platform: sm2235
    id: sm2235_blue
    channel: 2
  - platform: sm2235
    id: sm2235_coldwhite
    channel: 4
  - platform: sm2235
    id: sm2235_warmwhite
    channel: 3
  - platform: sm2335
    id: sm2335_red
    channel: 1
  - platform: sm2335
    id: sm2335_green
    channel: 0
  - platform: sm2335
    id: sm2335_blue
    channel: 2
  - platform: sm2335
    id: sm2335_coldwhite
    channel: 4
  - platform: sm2335
    id: sm2335_warmwhite
    channel: 3
  - platform: slow_pwm
    id: id24
    pin:
      allow_other_uses: true
      number: GPIO26
    period: 15s
  - platform: mcp4725
    id: mcp4725_dac_output
    i2c_id: i2c_bus
  - platform: mcp4728
    id: mcp4728_dac_output_a
    channel: A
    vref: vdd
    power_down: normal
  - platform: mcp4728
    id: mcp4728_dac_output_b
    channel: B
    vref: internal
    gain: X1
    power_down: gnd_1k
  - platform: mcp4728
    id: mcp4728_dac_output_c
    channel: C
    vref: vdd
    power_down: gnd_100k
  - platform: mcp4728
    id: mcp4728_dac_output_d
    channel: D
    vref: internal
    gain: X2
    power_down: gnd_500k
  - platform: x9c
    id: test_x9c
    cs_pin:
      allow_other_uses: true
      number: GPIO25
    inc_pin:
      allow_other_uses: true
      number: GPIO26
    ud_pin:
      number: GPIO27
    initial_value: 0.5

light:
  - platform: binary
    name: Desk Lamp
    output: gpio_26
    effects:
      - strobe:
      - strobe:
          name: My Strobe
          colors:
            - state: true
              duration: 250ms
            - state: false
              duration: 250ms

remote_transmitter:
  - pin:
      allow_other_uses: true
      number: 32
    carrier_duty_percent: 100%

climate:
  - platform: tcl112
    name: TCL112 Climate With Sensor
    supports_heat: true
    supports_cool: true
    sensor: ${sensorname}_sensor
  - platform: tcl112
    name: TCL112 Climate
    action_state_topic: action/state/topic
    away_command_topic: away/command/topic
    away_state_topic: away/state/topic
    current_temperature_state_topic: current/temperature/state/topic
    fan_mode_command_topic: fan_mode/mode/command/topic
    fan_mode_state_topic: fan_mode/mode/state/topic
    mode_command_topic: mode/command/topic
    mode_state_topic: mode/state/topic
    swing_mode_command_topic: swing_mode/command/topic
    swing_mode_state_topic: swing_mode/state/topic
    target_temperature_command_topic: target/temperature/command/topic
    target_temperature_high_command_topic: target/temperature/high/command/topic
    target_temperature_high_state_topic: target/temperature/high/state/topic
    target_temperature_low_command_topic: target/temperature/low/command/topic
    target_temperature_low_state_topic: target/temperature/low/state/topic
    target_temperature_state_topic: target/temperature/state/topic
  - platform: mitsubishi
    name: Mitsubishi
    supports_dry: "true"
    supports_fan_only: "true"
    horizontal_default: "left"
    vertical_default: "down"
  - platform: midea_ir
    name: Midea IR
    use_fahrenheit: true
  - platform: midea
    on_control:
      - logger.log: Control message received!
      - lambda: |-
          x.set_mode(CLIMATE_MODE_FAN_ONLY);
    on_state:
      - logger.log: State changed!
      - lambda: |-
          if (x.mode == CLIMATE_MODE_FAN_ONLY)
            id(binary_sensor1).publish_state(true);
    id: midea_unit
    uart_id: uart_0
    name: Midea Climate
    transmitter_id:
    period: 1s
    num_attempts: 5
    timeout: 2s
    beeper: false
    autoconf: true
    visual:
      min_temperature: 17 °C
      max_temperature: 30 °C
      temperature_step: 0.5 °C
    supported_modes:
      - FAN_ONLY
      - HEAT_COOL
      - COOL
      - HEAT
      - DRY
    custom_fan_modes:
      - SILENT
      - TURBO
    supported_presets:
      - ECO
      - BOOST
      - SLEEP
    custom_presets:
      - FREEZE_PROTECTION
    supported_swing_modes:
      - VERTICAL
      - HORIZONTAL
      - BOTH
    outdoor_temperature:
      name: Temp
    power_usage:
      name: Power
    humidity_setpoint:
      name: Humidity

script:
  - id: climate_custom
    then:
      - climate.control:
          id: midea_unit
          custom_preset: FREEZE_PROTECTION
          custom_fan_mode: SILENT
  - id: climate_preset
    then:
      - climate.control:
          id: midea_unit
          preset: SLEEP

switch:
  - platform: template
    name: MIDEA_AC_BEEPER_CONTROL
    optimistic: true
    turn_on_action:
      midea_ac.beeper_on:
    turn_off_action:
      midea_ac.beeper_off:
  - platform: template
    name: MIDEA_RAW
    turn_on_action:
      - remote_transmitter.transmit_midea:
          code: [0xA2, 0x08, 0xFF, 0xFF, 0xFF]
      - remote_transmitter.transmit_midea:
          code: !lambda "return {0xA2, 0x08, 0xFF, 0xFF, 0xFF};"
  - platform: gpio
    name: "MCP23S08 Pin #0"
    pin:
      mcp23xxx: mcp23s08_hub
      # Use pin number 0
      number: 0
      mode: OUTPUT
      inverted: false
  - platform: gpio
    name: "MCP23S17 Pin #0"
    pin:
      mcp23xxx: mcp23s17_hub
      # Use pin number 0
      number: 1
      allow_other_uses: true
      mode: OUTPUT
      inverted: false
  - platform: gpio
    pin:
      allow_other_uses: true
      number: GPIO25
    name: Living Room Dehumidifier
    icon: "mdi:restart"
    inverted: true
    command_topic: custom_command_topic
    command_retain: true
    restore_mode: ALWAYS_OFF
  - platform: template
    name: JVC Off
    id: living_room_lights_on
    turn_on_action:
      remote_transmitter.transmit_jvc:
        data: 0x10EF
  - platform: template
    name: MagiQuest
    turn_on_action:
      remote_transmitter.transmit_magiquest:
        wand_id: 0x01234567
  - platform: template
    name: NEC
    id: living_room_lights_off
    turn_on_action:
      remote_transmitter.transmit_nec:
        address: 0x4242
        command: 0x8484
  - platform: template
    name: LG
    turn_on_action:
      remote_transmitter.transmit_lg:
        data: 4294967295
        nbits: 28
  - platform: template
    name: Samsung
    turn_on_action:
      remote_transmitter.transmit_samsung:
        data: 0xABCDEF
  - platform: template
    name: Samsung36
    turn_on_action:
      remote_transmitter.transmit_samsung36:
        address: 0x0400
        command: 0x000E00FF
  - platform: template
    name: Sony
    turn_on_action:
      remote_transmitter.transmit_sony:
        data: 0xABCDEF
        nbits: 12
  - platform: template
    name: Panasonic
    turn_on_action:
      remote_transmitter.transmit_panasonic:
        address: 0x4004
        command: 0x1000BCD
  - platform: template
    name: Pioneer
    turn_on_action:
      - remote_transmitter.transmit_pioneer:
          rc_code_1: 0xA556
          rc_code_2: 0xA506
          repeat:
            times: 2
  - platform: template
    name: RC Switch Raw
    turn_on_action:
      remote_transmitter.transmit_rc_switch_raw:
        code: "00101001100111110101xxxx"
        protocol: 1
  - platform: template
    name: RC Switch Type A
    turn_on_action:
      remote_transmitter.transmit_rc_switch_type_a:
        group: "11001"
        device: "01000"
        state: true
        protocol:
          pulse_length: 175
          sync: [1, 31]
          zero: [1, 3]
          one: [3, 1]
          inverted: false
  - platform: template
    name: RC Switch Type B
    turn_on_action:
      remote_transmitter.transmit_rc_switch_type_b:
        address: 4
        channel: 2
        state: true
  - platform: template
    name: RC Switch Type C
    turn_on_action:
      remote_transmitter.transmit_rc_switch_type_c:
        family: "a"
        group: 1
        device: 2
        state: true
  - platform: template
    name: RC Switch Type D
    turn_on_action:
      remote_transmitter.transmit_rc_switch_type_d:
        group: "a"
        device: 2
        state: true
  - platform: template
    name: RC5
    turn_on_action:
      remote_transmitter.transmit_rc5:
        address: 0x00
        command: 0x0B
  - platform: template
    name: RC5
    turn_on_action:
      remote_transmitter.transmit_raw:
        code: [1000, -1000]
  - platform: template
    name: AEHA
    id: eaha_hitachi_climate_power_on
    turn_on_action:
      remote_transmitter.transmit_aeha:
        address: 0x8008
        data:
          [
            0x00,
            0x02,
            0xFD,
            0xFF,
            0x00,
            0x33,
            0xCC,
            0x49,
            0xB6,
            0xC8,
            0x37,
            0x16,
            0xE9,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0xCA,
            0x35,
            0x8F,
            0x70,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0x00,
            0xFF,
            0x00,
            0xFF,
          ]
  - platform: template
    name: Haier
    turn_on_action:
      remote_transmitter.transmit_haier:
        code:
          [
            0xA6,
            0xDA,
            0x00,
            0x00,
            0x40,
            0x40,
            0x00,
            0x80,
            0x00,
            0x00,
            0x00,
            0x00,
            0x05,
          ]
  - platform: template
    name: Living Room Lights
    id: livingroom_lights
    optimistic: true
    assumed_state: true
    turn_on_action:
      - output.set_level:
          id: mcp4725_dac_output
          level: !lambda "return 0.5;"
      - output.set_level:
          id: mcp4728_dac_output_a
          level: !lambda "return 0.5;"
    on_turn_on:
      - switch.template.publish:
          id: livingroom_lights
          state: true
  - platform: restart
    name: Living Room Restart
  - platform: safe_mode
    name: Living Room Restart (Safe Mode)
  - platform: shutdown
    name: Living Room Shutdown
  - platform: output
    name: Generic Output
    output: pca_6
  - platform: template
    name: Template Switch
    id: my_switch
    lambda: |-
      if (id(binary_sensor1).state) {
        return true;
      } else {
        return {};
      }
      id(my_switch).publish_state(false);
      id(my_switch).publish_state(true);
      if (id(my_switch).state) {
        // Switch is ON, do something here
        id(my_switch).turn_off();
        id(my_switch).turn_on();
      } else {
        // Switch is OFF, do something else here
      }
    optimistic: true
    assumed_state: false
    on_turn_off:
      - switch.template.publish:
          id: my_switch
          state: !lambda "return false;"
  - platform: uart
    uart_id: uart_0
    name: UART String Output
    data: DataToSend
  - platform: uart
    uart_id: uart_0
    name: UART Bytes Output
    data: [0xDE, 0xAD, 0xBE, 0xEF]
  - platform: uart
    uart_id: uart_0
    name: UART Recurring Output
    data: [0xDE, 0xAD, 0xBE, 0xEF]
    send_every: 1s
  - platform: uart
    uart_id: uart_0
    name: "UART On/Off"
    data:
      turn_on: "TurnOn\r\n"
      turn_off: "TurnOff\r\n"

  - platform: gpio
    name: "SN74HC595 Pin #0"
    pin:
      sn74hc595: sn74hc595_hub_2
      # Use pin number 0
      number: 0
      inverted: false
  - platform: template
    id: ble1_status
    optimistic: true
  - platform: template
    id: outlet_switch
    optimistic: true
    device_class: outlet
  - platform: micronova
    stove:
      name: Stove on/off

interval:
  - interval: 60min
    then:
      - ble_client.connect: ble_blah
      - ble_client.ble_write:
          id: ble_blah
          service_uuid: EBE0CCB0-7A0A-4B0C-8A1A-6FF2997DA3A6
          characteristic_uuid: EBE0CCB7-7A0A-4B0C-8A1A-6FF2997DA3A6
          value: !lambda |-
            return {1, 0};
      - ble_client.disconnect: ble_blah

color:
  - id: kbx_red
    red: 100%
    green_int: 123
    blue: 2%
  - id: kbx_blue
    red: 0%
    green: 1%
    blue: 100%
  - id: kbx_green
    hex: "3DEC55"

display:
  - platform: max7219
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    num_chips: 1
    lambda: |-
      it.print("01234567");
  - platform: tm1637
    clk_pin:
      allow_other_uses: true
      number: GPIO23
    dio_pin:
      allow_other_uses: true
      number: GPIO25
    intensity: 3
    lambda: |-
      it.print("1234");
  - platform: tm1637
    clk_pin:
      mcp23xxx: mcp23017_hub
      number: 1
      allow_other_uses: true
    dio_pin:
      mcp23xxx: mcp23017_hub
      number: 2
    intensity: 3
    inverted: true
    length: 4
    lambda: |-
      it.print("1234");
  - platform: pcd8544
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    contrast: 60
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1306_spi
    model: SSD1306 128x64
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1322_spi
    model: SSD1322 256x64
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1325_spi
    model: SSD1325 128x64
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1327_i2c
    model: SSD1327 128X128
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    address: 0x3D
    id: display1327
    brightness: 60%
    pages:
      - id: page13271
        lambda: |-
          it.rectangle(0, 0, it.get_width(), it.get_height());
      - id: page13272
        lambda: |-
          // Nothing
    i2c_id: i2c_bus
  - platform: ssd1327_spi
    model: SSD1327 128x128
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1331_spi
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: ssd1351_spi
    model: SSD1351 128x128
    cs_pin:
      allow_other_uses: true
      number: GPIO23
    dc_pin:
      allow_other_uses: true
      number: GPIO23
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: st7789v
    model: TTGO TDisplay 135x240
    cs_pin:
      allow_other_uses: true
      number: GPIO5
    dc_pin:
      allow_other_uses: true
      number: GPIO16
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    backlight_pin: false
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: st7920
    width: 128
    height: 64
    cs_pin:
      allow_other_uses: true
      number: GPIO23
      inverted: true
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: st7567_i2c
    id: st7735_display_i2c
    address: 0x3F
    i2c_id: i2c_bus
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: st7567_spi
    id: st7735_display_spi
    cs_pin:
      allow_other_uses: true
      number: GPIO5
    dc_pin:
      allow_other_uses: true
      number: GPIO16
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: st7735
    id: st7735_display
    model: INITR_BLACKTAB
    cs_pin:
      allow_other_uses: true
      number: GPIO5
    dc_pin:
      allow_other_uses: true
      number: GPIO16
    reset_pin:
      allow_other_uses: true
      number: GPIO23
    rotation: 0
    device_width: 128
    device_height: 160
    col_start: 0
    row_start: 0
    lambda: |-
      it.rectangle(0, 0, it.get_width(), it.get_height());
  - platform: pvvx_mithermometer
    ble_client_id: ble_foo
    time_id: sntp_time
    disconnect_delay: 3s
    update_interval: 10min
    validity_period: 20min
    lambda: |-
      it.print_bignum(188.8);
      it.print_unit(pvvx_mithermometer::UNIT_DEG_E);
      it.print_smallnum(88);
      it.print_percent(true);
      it.print_happy(true);
      it.print_sad(true);
      it.print_bracket(true);
      it.print_battery(true);
  - platform: tm1621
    id: tm1621_display
    cs_pin:
      allow_other_uses: true
      number: GPIO17
    data_pin:
      allow_other_uses: true
      number: GPIO5
    read_pin:
      allow_other_uses: true
      number: GPIO23
    write_pin:
      allow_other_uses: true
      number: GPIO18
    lambda: |-
      it.printf(0, "%.1f", id(dallas_temperature).state);
      it.display_celsius(true);

tm1651:
  id: tm1651_battery
  clk_pin:
    allow_other_uses: true
    number: GPIO23
  dio_pin:
    allow_other_uses: true
    number: GPIO23

status_led:
  pin:
    allow_other_uses: true
    number: GPIO2
    ignore_strapping_warning: true

pn532_spi:
  id: pn532_bs
  cs_pin:
    allow_other_uses: true
    number: GPIO23
  update_interval: 1s
  on_tag:
    - lambda: |-
        ESP_LOGD("main", "Found tag %s", x.c_str());
    - mqtt.publish:
        topic: the/topic
        payload: !lambda "return x;"
  on_tag_removed:
    - lambda: |-
        ESP_LOGD("main", "Removed tag %s", x.c_str());
    - mqtt.publish:
        topic: the/topic
        payload: !lambda "return x;"

pn532_i2c:
  i2c_id: i2c_bus

pn7150_i2c:
  id: nfcc_pn7150_i2c
  i2c_id: i2c_bus
  irq_pin:
    allow_other_uses: true
    number: GPIO32
  ven_pin:
    allow_other_uses: true
    number: GPIO16

pn7160_i2c:
  id: nfcc_pn7160_i2c
  i2c_id: i2c_bus
  dwl_req_pin:
    allow_other_uses: true
    number: GPIO17
  irq_pin:
    allow_other_uses: true
    number: GPIO35
  ven_pin:
    allow_other_uses: true
    number: GPIO16
  wkup_req_pin:
    allow_other_uses: true
    number: GPIO21
  emulation_message: https://www.home-assistant.io/tag/pulse_ce
  tag_ttl: 1000ms

pn7160_spi:
  id: nfcc_pn7160_spi
  cs_pin:
    number: GPIO15
  dwl_req_pin:
    allow_other_uses: true
    number: GPIO17
  irq_pin:
    allow_other_uses: true
    number: GPIO35
  ven_pin:
    allow_other_uses: true
    number: GPIO16
  wkup_req_pin:
    allow_other_uses: true
    number: GPIO21
  emulation_message: https://www.home-assistant.io/tag/pulse_ce
  tag_ttl: 1000ms

rdm6300:
  uart_id: uart_0

rc522_spi:
  cs_pin:
    allow_other_uses: true
    number: GPIO23
  update_interval: 1s
  on_tag:
    - lambda: |-
        ESP_LOGD("main", "Found tag %s", x.c_str());

rc522_i2c:
  - update_interval: 1s
    on_tag:
      - lambda: |-
          ESP_LOGD("main", "Found tag %s", x.c_str());
    i2c_id: i2c_bus

  - update_interval: 1s
    on_tag:
      - lambda: |-
          ESP_LOGD("main", "Found tag %s", x.c_str());
    i2c_id: i2c_bus

mcp4728:
  - id: mcp4728_dac
    store_in_eeprom: false
    address: 0x60
    i2c_id: i2c_bus

time:
  - platform: sntp
    id: sntp_time
    servers:
      - 0.pool.ntp.org
      - 1.pool.ntp.org
      - 192.168.178.1
    on_time:
      cron: "/30 0-30,30/5 * ? JAN-DEC MON,SAT-SUN,TUE-FRI"
      then:
        - lambda: 'ESP_LOGD("main", "time");'
cover:
  - platform: template
    name: Template Cover
    id: template_cover
    lambda: |-
      if (id(binary_sensor1).state) {
        return COVER_OPEN;
      } else {
        return {};
      }
    optimistic: true
    open_action:
      - cover.template.publish:
          id: template_cover
          state: CLOSED
    assumed_state: false
    has_position: true
    position_state_topic: position/state/topic
    position_command_topic: position/command/topic
    tilt_lambda: !lambda "return 0.5;"
    tilt_state_topic: tilt/state/topic
    tilt_command_topic: tilt/command/topic
    on_open:
      then:
        - lambda: 'ESP_LOGD("cover", "open");'
    on_closed:
      then:
        - lambda: 'ESP_LOGD("cover", "closed");'

debug:

tca9548a:
  - address: 0x70
    id: multiplex0
    channels:
      - bus_id: multiplex0_chan0
        channel: 0
    i2c_id: i2c_bus
  - address: 0x71
    id: multiplex1
    i2c_id: multiplex0_chan0

pcf8574:
  - id: pcf8574_hub
    address: 0x21
    pcf8575: false
    i2c_id: i2c_bus

pca9554:
  - id: pca9554_hub
    pin_count: 8
    address: 0x3F
    i2c_id: i2c_bus

pca6416a:
  - id: pca6416a_hub
    address: 0x21
    i2c_id: i2c_bus

mcp23017:
  - id: mcp23017_hub
    open_drain_interrupt: true
    i2c_id: i2c_bus

mcp23008:
  - id: mcp23008_hub
    address: 0x22
    open_drain_interrupt: true
    i2c_id: i2c_bus

mcp23016:
  - id: mcp23016_hub
    address: 0x23
    i2c_id: i2c_bus

globals:
  - id: glob_int
    type: int
    restore_value: true
    initial_value: "0"
  - id: glob_float
    type: float
    restore_value: true
    initial_value: "0.0f"
  - id: glob_bool
    type: bool
    restore_value: false
    initial_value: "true"
  - id: glob_string
    type: std::string
    restore_value: false
    # initial_value: ""
  - id: glob_bool_processed
    type: bool
    restore_value: false
    initial_value: "false"

text_sensor:
  - platform: ble_client
    ble_client_id: ble_foo
    name: Sensor Location
    service_uuid: "180d"
    characteristic_uuid: "2a38"
    descriptor_uuid: "2902"
    notify: true
    update_interval: never
    on_notify:
      then:
        - lambda: |-
            ESP_LOGD("green_btn", "Location changed: %s", x.c_str());
  - platform: mqtt_subscribe
    name: MQTT Subscribe Text
    topic: "the/topic"
    qos: 2
    on_value:
      - text_sensor.template.publish:
          id: ${textname}_text
          state: Hello World
      - text_sensor.template.publish:
          id: ${textname}_text
          state: |-
            return "Hello World2";
      - globals.set:
          id: glob_int
          value: "0"
  - platform: template
    name: Template Text Sensor
    id: ${textname}_text
  - platform: template
    name: Template Text Sensor Timestamp
    id: ${textname}_text_timestamp
    device_class: timestamp
  - platform: teleinfo
    tag_name: OPTARIF
    name: optarif
    teleinfo_id: myteleinfo

sn74hc595:
  - id: sn74hc595_hub
    data_pin:
      allow_other_uses: true
      number: GPIO21
    clock_pin:
      allow_other_uses: true
      number: GPIO23
    latch_pin:
      allow_other_uses: true
      number: GPIO22
    oe_pin:
      allow_other_uses: true
      number: GPIO32
    sr_count: 2
  - id: sn74hc595_hub_2
    latch_pin:
      allow_other_uses: true
      number: GPIO22
    oe_pin:
      allow_other_uses: true
      number: GPIO32
    sr_count: 2
    spi_id: spi_bus

rtttl:
  output: gpio_19

teleinfo:
  id: myteleinfo
  uart_id: uart_0
  update_interval: 60s
  historical_mode: true

number:
  - platform: template
    id: test_number
    state_topic: livingroom/custom_state_topic
    command_topic: livingroom/custom_command_topic
    min_value: 0
    step: 1
    max_value: 10
    optimistic: true
  - platform: micronova
    thermostat_temperature:
      name: Micronova Thermostaat
      step: 1
    power_level:
      name: Micronova Power level

button:
  - platform: template
    name: Start calibration
    on_press:
      - scd4x.perform_forced_calibration:
          value: 419
          id: scd40
      - scd4x.factory_reset:
          id: scd40
  - platform: template
    name: Midea Display Toggle
    on_press:
      midea_ac.display_toggle:
  - platform: template
    name: Midea Swing Step
    on_press:
      midea_ac.swing_step:
  - platform: template
    name: Midea Power On
    on_press:
      midea_ac.power_on:
  - platform: template
    name: Midea Power Off
    on_press:
      midea_ac.power_off:
  - platform: template
    name: Midea Power Inverse
    on_press:
      midea_ac.power_toggle:
  - platform: template
    name: Poller component suspend test
    on_press:
      - component.suspend: myteleinfo
      - delay: 20s
      - component.update: myteleinfo
      - delay: 20s
      - component.resume: myteleinfo
      - delay: 20s
      - component.resume:
          id: myteleinfo
          update_interval: 2s
      - delay: 20s
      - component.resume:
          id: myteleinfo
          update_interval: !lambda return 2500;
  - platform: uart
    uart_id: uart_0
    name: UART button
    data: "Pressed\r\n"
  - platform: micronova
    custom_button:
      name: Custom Micronova Button
      memory_location: 0xA0
      memory_address: 0x7D
      memory_data: 0x0F
